% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fx_helpers.R
\name{make_fx_quote_rates_matrix}
\alias{make_fx_quote_rates_matrix}
\title{Make FX Quote Currency Rates Matrix}
\usage{
make_fx_quote_rates_matrix(prices_df, pair_quote_currencies, usd_rates_df)
}
\arguments{
\item{prices_df}{Long dataframe with pair, date, close columns}

\item{pair_quote_currencies}{Named vector mapping pair names to their quote currency
e.g., c(EURUSD = "USD", USDJPY = "JPY", EURJPY = "JPY")}

\item{usd_rates_df}{Long dataframe with columns: currency, date, rate
where rate is the XXX/USD rate. For quote currency conversion,
the function will compute 1/USDXXX = XXX/USD rate.
USD should have rate = 1.0}
}
\value{
Wide matrix suitable for fx_backtest quote_currency_rates parameter
}
\description{
Build a matrix of quote currency conversion rates for P&L reporting.
For each FX pair, this provides a multiplier to convert quote-currency P&L to USD.
For pairs where the quote currency is USD, this is 1.0.
For other pairs, this is 1/USDXXX (e.g., 1/USDJPY for JPY-denominated P&L).
}
\examples{
\dontrun{
pair_quote <- c(EURUSD = "USD", USDJPY = "JPY", EURJPY = "JPY")

# Note: For JPY, you need the USD/JPY rate data, which will be inverted
usd_rates_df <- data.frame(
  currency = c("USD", "USD", "JPY", "JPY"),
  date = as.Date(c("2024-01-01", "2024-01-02", "2024-01-01", "2024-01-02")),
  rate = c(1.0, 1.0, 0.009091, 0.009009)  # JPY rate is 1/USDJPY
)

quote_rates <- make_fx_quote_rates_matrix(prices_df, pair_quote, usd_rates_df)
}
}
